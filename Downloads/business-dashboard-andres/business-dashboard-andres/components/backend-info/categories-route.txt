const express = require('express');
const { body } = require('express-validator');
const { auth } = require('../middleware/auth');
const CategoryController = require('../controllers/categoryController');

const router = express.Router();

// Get all categories for a company
router.get('/', auth, CategoryController.getAllCategories);

// Get single category
router.get('/:id', auth, CategoryController.getCategoryById);

// Create new category
router.post('/', auth, [
  body('categoryName').trim().isLength({ min: 1 }).withMessage('Category name is required'),
  body('categoryCode').trim().isLength({ min: 1 }).withMessage('Category code is required'),
  body('branchId').optional().isMongoId().withMessage('Invalid branch ID format'),
], CategoryController.createCategory);

// Update category
router.put('/:id', auth, [
  body('categoryName').optional().trim().isLength({ min: 1 }).withMessage('Category name is required'),
  body('categoryCode').optional().trim().isLength({ min: 1 }).withMessage('Category code is required'),
  body('branchId').optional().isMongoId().withMessage('Invalid branch ID format'),
  body('status').optional().isInt({ min: 0, max: 1 }).withMessage('Status must be 0 or 1'),
], CategoryController.updateCategory);

// Delete category
router.delete('/:id', auth, CategoryController.deleteCategory);

module.exports = router;
